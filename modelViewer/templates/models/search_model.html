{% extends 'home.html' %}

{% block search %}
  <h2>Model List</h2>

    <form method="get" action="{% url 'model_list' %}">
        <div class="text-white">
            <label for="model_name">Search by Model Name:</label>
            <input type="text" name="model_name">

            <label for="category">Filter by Category:</label>
            <select name="category">
                <option value="" selected>All Categories</option>
                {% for category in categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>

            <label for="upload_date">Filter by Upload Date:</label>
            <input type="date" name="upload_date">

            <label for="sort_by">Sort by:</label>
            <select name="sort_by">
                <option value="" selected>None</option>
                <option value="newest">Newest</option>
                <option value="oldest">Oldest</option>
            </select>

            <button type="submit">Apply Filters</button>
        </div>
    </form>
    <div class="w3-container text-white">
        <div class="row">
             {% for model in models %}
                <div class="col-md-4 mb-4">
                    <div class="w3-card-4 border border-danger bg-secondary" style="height: 100%;">
                        <img src="{{ model.image.url }}" alt="{{ model.title }}" style="width:100%; height:500px; object-fit: cover;" class="img-fluid">
                        <button class="btn btn-info delete-btn mt-2 w-100">
                                <a class="text-white text-decoration-none" href="{% url 'model' model.id %}">View Model</a>
                        </button>
                        <div style="clear: both;"></div>
                        <h2 class="text-center">{{ model.title }}</h2>
                        <div class="w3-container w3-center ml-2">

                            <strong>{{ model.title }}</strong> by {{ model.user.username }}<br>
                            Description: {{ model.description }}<br>
                            Upload Date: {{ model.upload_date }}<br>
                            Categories:
                            {% for category in model.categories.all %}
                              {{ category.name }}
                            {% endfor %}
                            <br>
                            <div class="rating-container">
                                <p>Rating: {{ model.rating_average|default:"Not rated" }}</p>
                                <div class="rating" data-model-id="{{ model.id }}">
                                    <!-- Zde zobrazte hvězdičky podle hodnocení modelu -->
                                </div>
                                <form>
                                    1
                                    <input type="radio" name="rating" value="1">
                                    <input type="radio" name="rating" value="2">
                                    <input type="radio" name="rating" value="3">
                                    <input type="radio" name="rating" value="4">
                                    <input type="radio" name="rating" value="5">
                                    5
                                    <button type="button" class="rate-model">Rate Model</button>
                                </form>
                                <p class="rating-error" style="color: red;"></p> <!-- Zde zobrazte chybovou zprávu -->
                            </div>
                        </div>
                            <div class="mt-2">
                                <button class="btn btn-success delete-btn float-left">
                                    <a class="text-white text-decoration-none" href="{% url 'model' model.id %}">View Model</a>
                                </button>

                                <button class="btn btn-primary delete-btn float-right">
                                    <a class="text-white text-decoration-none" href="{{ model.file.url }}" target="_blank">Download Model</a>
                                </button>
                            </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}